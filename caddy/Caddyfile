# Dynamic domain from environment variable
{$DOMAIN:example.com} {
  # Use staging certificates by default to avoid rate limits
  tls {
    ca {$TLS_CA:https://acme-staging-v02.api.letsencrypt.org/directory}
  }

  encode gzip
  log {
    output file /var/log/caddy/access.log
  }

  handle /api/** {
    reverse_proxy server:3001
  }

  handle {
    reverse_proxy frontend:80
  }
}

