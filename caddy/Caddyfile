# Dynamic domain from environment variable
{$DOMAIN:tradingibs.site} {
  # Use production certificates by default
  tls {
    ca {$TLS_CA:https://acme-v02.api.letsencrypt.org/directory}
  }

  encode gzip
  log {
    output file /var/log/caddy/access.log
  }

  handle /api/** {
    reverse_proxy server:3001
  }

  handle {
    reverse_proxy frontend:80
  }
}

